steps:
  - script: npm install -g @typespec/compiler@next
    displayName: Install @typespec/compiler@next
  - script: npm run update-typespec
    workingDirectory: $(Build.SourcesDirectory)
    displayName: "Override global pnpm-config to dev"
  - script: npx @azure-tools/typespec-bump-deps@latest package.json
    workingDirectory: $(Build.SourcesDirectory)/packages/typespec-ts
    displayName: "Override typespec-ts package.json to dev"
  - script: npx @azure-tools/typespec-bump-deps@latest package.json
    workingDirectory: $(Build.SourcesDirectory)/packages/typespec-test
    displayName: "Override typespec-test package.json to dev"
  - script: |
      npm install -g pnpm
    displayName: "Install Pnpm"
  - script: |
      pnpm install --no-frozen-lockfile
    displayName: "Install package dependencies"
  - script: |
      pnpm build
    displayName: "Build"
