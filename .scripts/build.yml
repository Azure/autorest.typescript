steps:
  - task: NodeTool@0
    inputs:
      versionSpec: "10.x"
    displayName: "Install Node.js"
  - script: |
      npm install
      npm run build
      npm pack
    displayName: "Build"

  - task: CopyFiles@2
    inputs:
      contents: "*.tgz"
      targetFolder: $(Build.ArtifactStagingDirectory)
      flattenFolders: true
    displayName: "Copy packages"

  - task: PublishPipelineArtifact@1
    condition: succeededOrFailed()
    displayName: "Publish artifacts"
    inputs:
      artifactName: packages
      path: $(Build.ArtifactStagingDirectory)
