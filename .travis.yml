language: node_js
sudo: required
addons:
  chrome: stable
node_js:
  - "8"
cache:
  directories:
    - $HOME/.npm
before_script:
  - npm install -g gulp-cli
stages:
  - test
jobs:
  include:
    - stage: test
      install: npm install --ignore-scripts
      script: gulp testci/typecheck
      env: CHECK_NAME="Typecheck"
    - stage: test
      install: npm install --ignore-scripts
      script: gulp testci/nodejs-unit
      env: CHECK_NAME="Node.js Tests"
    - stage: test
      install: npm install --ignore-scripts
      script: gulp testci/chrome-unit
      env: CHECK_NAME="Chrome Tests"
    - stage: test
      install:
          # dotnet 2.0 prereq
        - sudo apt-get install libunwind8
        - npm install
      script: gulp testci/generator-unit
      env: CHECK_NAME=".NET Core Unit Tests"
    - stage: test
      install:
          # dotnet 2.0 prereq
        - sudo apt-get install libunwind8
        - npm install
      script: gulp testci/regenerate-ts
      env: CHECK_NAME="Regenerate Vanilla"
    - stage: test
      install:
          # dotnet 2.0 prereq
        - sudo apt-get install libunwind8
        - npm install
      script: gulp testci/regenerate-tsazure
      env: CHECK_NAME="Regenerate Azure"
    - stage: test
      install: npm install --ignore-scripts
      script: npm run bundle-size
      env: CHECK_NAME="Bundle Size"
