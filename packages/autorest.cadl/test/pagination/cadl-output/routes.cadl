import "@azure-tools/cadl-azure-core";
import "@cadl-lang/rest";
import "./models.cadl";

using Cadl.Rest;
using Cadl.Http;

namespace AutoRestPagingTestService;

interface PagingOperations {
  @doc("A paging operation that must return result of the default 'value' node.")
  GetNoItemNamePages is Azure.Core.ResourceList<
    Product,
    {
      parameters: {};
    }
  >;

  @doc("A paging operation that must ignore any kind of nextLink, and stop after page 1.")
  GetNullNextLinkNamePages is Azure.Core.ResourceList<
    Product,
    {
      parameters: {};
    }
  >;

  @doc("A paging operation that finishes on the first call without a nextlink")
  GetSinglePages is Azure.Core.ResourceList<
    Product,
    {
      parameters: {};
    }
  >;

  @doc("""
A paging operation whose first response's items list is empty, but still
returns a next link. Second (and final) call, will give you an items list of 1.
""")
  FirstResponseEmpty is Azure.Core.ResourceList<
    Product,
    {
      parameters: {};
    }
  >;

  @doc("A paging operation that includes a nextLink that has 10 pages")
  GetMultiplePages is Azure.Core.ResourceList<
    Product,
    {
      parameters: {
        @header "client-request-id": string;

        @doc("Sets the maximum number of items to return in the response.")
        @header
        maxresults: int32;

        @doc("""
Sets the maximum time that the server can spend processing the request, in
seconds. The default is 30 seconds.
""")
        @header
        timeout: int32;
      };
    }
  >;

  @doc("""
A paging operation that includes a next operation. It has a different query
parameter from it's next operation nextOperationWithQueryParams. Returns a
ProductResult
""")
  GetWithQueryParams is Azure.Core.ResourceList<
    Product,
    {
      parameters: {
        @doc("A required integer query parameter. Put in value '100' to pass test.")
        @query
        requiredQueryParameter: int32;

        @doc("""
A constant. Must be True and will be passed as a query parameter to
nextOperationWithQueryParams
""")
        @query
        queryConstant: true;
      };
    }
  >;

  @doc("""
Define `filter` as a query param for all calls. However, the returned next link
will also include the `filter` as part of it. Make sure you don't end up
duplicating the `filter` param in the url sent.
""")
  DuplicateParams is Azure.Core.ResourceList<
    Product,
    {
      parameters: {
        @doc("OData filter options. Pass in 'foo'")
        @query
        $filter: string;
      };
    }
  >;

  @doc("Paging with max page size. We don't want to ")
  PageWithMaxPageSize is Azure.Core.ResourceList<
    Product,
    {
      parameters: {
        @doc("Max page size query param. Don't send")
        @query
        $maxpagesize: "5";
      };
    }
  >;

  @doc("""
Next operation for getWithQueryParams. Pass in next=True to pass test. Returns
a ProductResult
""")
  NextOperationWithQueryParams is Azure.Core.ResourceList<
    Product,
    {
      parameters: {
        @doc("A constant. Must be True")
        @query
        queryConstant: true;
      };
    }
  >;

  @doc("A paging operation that includes a nextLink in odata format that has 10 pages")
  GetOdataMultiplePages is Azure.Core.ResourceList<
    Product,
    {
      parameters: {
        @header "client-request-id": string;

        @doc("Sets the maximum number of items to return in the response.")
        @header
        maxresults: int32;

        @doc("""
Sets the maximum time that the server can spend processing the request, in
seconds. The default is 30 seconds.
""")
        @header
        timeout: int32;
      };
    }
  >;

  @doc("A paging operation that includes a nextLink that has 10 pages")
  GetMultiplePagesWithOffset is Azure.Core.ResourceList<
    Product,
    {
      parameters: {
        @header "client-request-id": string;

        @doc("Sets the maximum number of items to return in the response.")
        @header
        maxresults: int32;

        @doc("Offset of return value")
        @path
        offset: int32;

        @doc("""
Sets the maximum time that the server can spend processing the request, in
seconds. The default is 30 seconds.
""")
        @header
        timeout: int32;
      };
    }
  >;

  @doc("""
A paging operation that fails on the first call with 500 and then retries and
then get a response including a nextLink that has 10 pages
""")
  GetMultiplePagesRetryFirst is Azure.Core.ResourceList<
    Product,
    {
      parameters: {};
    }
  >;

  @doc("""
A paging operation that includes a nextLink that has 10 pages, of which the 2nd
call fails first with 500. The client should retry and finish all 10 pages
eventually.
""")
  GetMultiplePagesRetrySecond is Azure.Core.ResourceList<
    Product,
    {
      parameters: {};
    }
  >;

  @doc("A paging operation that receives a 400 on the first call")
  GetSinglePagesFailure is Azure.Core.ResourceList<
    Product,
    {
      parameters: {};
    }
  >;

  @doc("A paging operation that receives a 400 on the second call")
  GetMultiplePagesFailure is Azure.Core.ResourceList<
    Product,
    {
      parameters: {};
    }
  >;

  @doc("A paging operation that receives an invalid nextLink")
  GetMultiplePagesFailureUri is Azure.Core.ResourceList<
    Product,
    {
      parameters: {};
    }
  >;

  @doc("A paging operation that doesn't return a full URL, just a fragment")
  GetMultiplePagesFragmentNextLink is Azure.Core.ResourceList<
    Product,
    {
      parameters: {
        @doc("Sets the api version to use.")
        @query
        api_version: string;

        @doc("Sets the tenant to use.")
        @path
        tenant: string;
      };
    }
  >;

  @doc("""
A paging operation that doesn't return a full URL, just a fragment with
parameters grouped
""")
  GetMultiplePagesFragmentWithGroupingNextLink is Azure.Core.ResourceList<
    Product,
    {
      parameters: {
        @doc("Sets the api version to use.")
        @query
        api_version: string;

        @doc("Sets the tenant to use.")
        @path
        tenant: string;
      };
    }
  >;

  @doc("A long-running paging operation that includes a nextLink that has 10 pages")
  // FIXME: (long-running-operation) This operation is long running please add the corresponding LRO decorators
  // for more information see: https://github.com/Azure/cadl-azure/tree/main/packages/cadl-azure-core#decorators
  GetMultiplePagesLRO is Azure.Core.ResourceList<
    Product,
    {
      parameters: {
        @header "client-request-id": string;

        @doc("Sets the maximum number of items to return in the response.")
        @header
        maxresults: int32;

        @doc("""
Sets the maximum time that the server can spend processing the request, in
seconds. The default is 30 seconds.
""")
        @header
        timeout: int32;
      };
    }
  >;

  @doc("""
A paging operation with api version. When calling the next link, you want to
append your client's api version to the next link
""")
  AppendApiVersion is Azure.Core.ResourceList<
    Product,
    {
      parameters: {};
    }
  >;

  @doc("""
A paging operation with api version. When calling the next link, you want to
reformat it and override the returned api version with your client's api
version
""")
  ReplaceApiVersion is Azure.Core.ResourceList<
    Product,
    {
      parameters: {};
    }
  >;

  @doc("A paging operation that doesn't return a full URL, just a fragment")
  NextFragment is Azure.Core.ResourceList<
    Product,
    {
      parameters: {
        @doc("Sets the api version to use.")
        @query
        api_version: string;

        @doc("Sets the tenant to use.")
        @path
        tenant: string;

        @doc("Next link for list operation.")
        @path
        nextLink: string;
      };
    }
  >;

  @doc("A paging operation that doesn't return a full URL, just a fragment")
  NextFragmentWithGrouping is Azure.Core.ResourceList<
    Product,
    {
      parameters: {
        @doc("Sets the api version to use.")
        @query
        api_version: string;

        @doc("Sets the tenant to use.")
        @path
        tenant: string;

        @doc("Next link for list operation.")
        @path
        nextLink: string;
      };
    }
  >;

  @doc("""
A paging operation that returns a paging model whose item name is is overriden
by x-ms-client-name 'indexes'.
""")
  GetPagingModelWithItemNameWithXMSClientName is Azure.Core.ResourceList<
    Product,
    {
      parameters: {};
    }
  >;
}
